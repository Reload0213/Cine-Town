<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="admin">
  
  <!-- 회원 정보 리스트 게시판 형식으로 불러오기 -->
  <select id="showUserInfoList" parameterType="userVO"	resultType="userVO">
  select userNum,userId,userPw,userName,userPhone,userEmail,userRegdate,userAddr1,userAddr2,userIsdelete,verify
  from user
  where verify = '0' and userIsdelete = 'N'
  <choose>
   <when test="userName != null">
      and userName like #{userName}
   </when>
  </choose>
  order by userNum 
  limit #{start},#{count}
  
  </select>
  
 
  <select id="selectUserCount" parameterType="userVO" resultType="int">
  select count(*)
  from user
  where verify = '0'
   <choose>
   <when test="userName != null">
      and userName like #{userName}
   </when>
  </choose>
  </select>
  
  <select id="showGoodsItem" parameterType="goodsVO" resultType="goodsVO">
  select gdsNum, gdsPrice, gdsStock, gdsViewcnt, gdsUUID, gdsName, gdsDetail, gdsRegdate, gdsIsdelete, gdsBrand, gdsImage1, gdsImage2
  from goods
  where gdsNum = #{gdsNum}
  </select>
  
  
  
  <!-- 관리자에서 회원삭제 쿼리  -->
  <update id="updateDeleteUser" parameterType="userVO" >
 update user
 set userIsdelete='Y'
  where userNum=#{userNum}

  </update>
  
  
  <!-- 어드민메일과 이너조인해서 가져오는 쿼리-->
  
  <select id="selectAdminMail" parameterType="adminMailBoxVO" resultType="adminMailBoxVO" >

 select b.sendDate ,b.mailNum ,a.userId ,b.content
FROM user a inner JOIN  adminmailbox b
on a.userNum = b.userNum
where isDelete='N'
order by sendDate desc
limit #{start}, #{count}	
  	

  
  </select>
  
   <select id="selectOneAdminMail" parameterType="adminMailBoxVO" resultType="adminMailBoxVO" >

 select b.sendDate,b.mailNum,a.userId,b.content
FROM user a inner JOIN  adminmailbox b
on a.userNum = b.userNum
where isDelete="N" and
mailNum=#{mailNum}

  	

  
  </select>
  
  
 
    <select id="selectAdminMailCount" parameterType="adminMailBoxVO" resultType="int">
select count(*)
 FROM user a inner JOIN  adminmailbox b
on a.userNum = b.userNum
  </select>
  
  
  <update id="updateDeleteAdminMail" parameterType="adminMailBoxVO" >
update adminmailbox
set isDelete='Y'
where mailNum=#{mailNum} and isDelete='N'
  </update>
  
  
  </mapper>
  
  
  